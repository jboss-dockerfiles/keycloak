<input type="text" id=in>
<pre><code id=out></code></pre>

<script>
window.killbugtodaySettings = { app_id: "12345", context:{$user_id: 'test'} };
!function(){function e(){var a=c.createElement("script");a.type="text/javascript",a.async=!0,a.src="/client.js?";
var b=c.getElementsByTagName("script")[0];b.parentNode.insertBefore(a,b)}var a=window,b=a.KillBug;if("function"==typeof b)b("update",killbugtodaySettings);else{var c=document,d=function(){d.c(arguments)};d.q=[],d.c=function(a){d.q.push(a)},a.KillBug=d,e();}}();
    /*(function() {
        'use strict';

        document.getElementById('out').innerText = '';
        document.getElementById('in').addEventListener('keydown', function(e) {
            if (e.key !== 'Enter') return true;

            const headers = new Headers();
            headers.append('Accept', 'text/json');

            const body = e.target.value;
            e.target.value = '';

            fetch(new Request('/pub', { method: 'POST', body, headers }));
        });

        const sub = new NchanSubscriber('/sub', {});
        //const subauth = new NchanSubscriber('/auth-sub?access_token=', {});

        sub.on("message", function(message, message_metadata) {
            // message is a string
            // message_metadata may contain 'id' and 'content-type'
            document.getElementById('out').innerText += `${message_metadata.id}: ${message}\n`;
        });

        sub.start();
    }).apply(this)*/
</script>
